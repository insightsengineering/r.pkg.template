---
name: WASM

on:
  push:
    branches:
      - wasm-poc
  workflow_call:
    secrets:
      REPO_GITHUB_TOKEN:
        description: |
          Github token with write access to the repository
        required: false

jobs:
  wasm:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v4

    - name: Build wasm packages
      uses: r-wasm/actions/build-rwasm@v1
      with:
        packages: |
          insightsengineering/tern@v0.9.4
          insightsengineering/teal.logger@v0.2.0
          insightsengineering/chevron@v0.2.6

    - name: Debug
      run: |
        apt-get update && apt-get install -yq tree
        ls -la
        tree _site
        cat _site/bin/emscripten/contrib/4.4/PACKAGES
